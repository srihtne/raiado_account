<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>マイページ</title>
</head>
<body>
  <h1>マイページ</h1>
  <p id="name"></p>
  <p id="date"></p>

  <script type="module">
    import { supabase } from './main.js';

    async function loadUser() {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) return window.location.href = 'index.html';

      const { data, error } = await supabase
        .from('serial_codes')
        .select('*')
        .eq('user_id', user.id)
        .single();

      if (error) return alert(error.message);

      document.getElementById('name').innerText = `ユーザー名: ${data.username}`;
      document.getElementById('date').innerText = `登録日: ${data.created_at}`;
    }

    loadUser();
  </script>
</body>
</html>
